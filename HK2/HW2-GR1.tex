\documentclass[12pt]{article}


\usepackage{fullpage,enumitem,amsmath,amsfonts,amssymb,amsthm,graphicx}
\usepackage{array} % Improves `tabular` and `array` environments
\usepackage{pict2e} % Allows \linethickness{...} in diagonal lines
\usepackage{diagbox}
\usepackage{breqn} % Fit equations in pages


\newcommand{\Z}{\mathbb{Z}}
\newcommand{\R}{\mathbb{R}}
\newcommand{\C}{\mathbb{C}}
\newcommand{\Q}{\mathbb{Q}}
\newcommand{\N}{\mathbb{N}}
\newcommand{\F}{\mathbb{F}}
\newcommand{\E}{\mathbb{E}}
\newcommand{\Exp}[1]{\text{exp}(#1)}
\newcommand{\Diag}[1]{\text{Diag}(#1)}
\newcommand{\norm}[1]{\left\Vert #1\right\Vert}
\newcommand{\Span}[1]{\text{Span}(#1)}
\newcommand{\Cov}[1]{\text{Cov}(#1)}

\newenvironment{solution}{\vspace{0.2cm} \textbf{Solution.}}{}
\setlength{\parindent}{0pt}

% ------------------------------------------------------------------- %

\title{\vspace{-3cm}2801.001 Spring 2018 Homework 1 }
\author{Martin Arienmughare -- \texttt{moa258}\\
		Madhur Bhattad-- \texttt{mb6854}\\
		Louis Guigo -- \texttt{lg2894}\\
		Mario Zhu -- \texttt{mz833}}
\date{May 2018}

% ------------------------------------------------------------------- %

\begin{document}

\maketitle

\textbf{Submission instructions:} Same groups as HW1. Refer to instructions from TA.
\\

\textbf{Note:} Problems 1 and 2 require the datafile posted online which contains prices and implied volatilities of one-year (349 calendar days) listed options on the Nasdaq 100 index (NDX), as well as other market data.

\noindent
\rule{\linewidth}{0.4pt}

\section*{Problem 1}

	\begin{enumerate}[label=(\alph*)]

		\item Estimate the market price of the $5\%$ call spread (i.e.\ with strikes ATM and $5\%$ OTM). What about the $5\%$ put spread?

		\begin{solution}

		The Nasdaq 100 data provided allows us to get the buy and sell prices of ATM (strike 5050) and $5\%$ OTM (strikes 5200 and 5750) call and put prices (we use midpoints).
		
		\begin{enumerate}
			\item[$\bullet$] Selling ATM Call: $337.1$.
			
			\item[$\bullet$] Selling ATM Put: $326.1$.
			
			\item[$\bullet$] Buying 5\% OTM Call: $478.1$.
			
			\item[$\bullet$] Buying 5\% OTM Put: $428.3$.
		\end{enumerate}
	
		Therefore, the buy prices of the 5\% call and put spreads are:
		
		\begin{enumerate}
			\item[$\bullet$] 5\% call spread: $478.1 - 337.1 = 141.0$.
			
			\item[$\bullet$] 5\% put spread: $428.3 - 326.1 = 100.2$.
		\end{enumerate}		

		\end{solution}
	
	\newpage

		\item If you were to price the spreads in the Black-Scholes model using a single volatility parameter $\sigma$, what value of $\sigma$ would match the theoretical price with the market price? Comment on your results.
	
		\begin{solution}

		Applying a Black-Scholes pricing formula would lead to the following theoretical prices for the 5\% call spread (5\% put spread resp.):
		
		\begin{dmath*}
		CS(K,0.95K) = C(0.95K) - C(K) =  S_t N(d_1(0.95K)) - 0.95K e^{-r(T-t)}N(d_2(0.95K)) - (S_t N(d_1(K)) - K e^{-r(T-t)}N(d_2(K)))
		\end{dmath*}
	
		\begin{dmath*}
		PS(K,1.05K) = P(1.05K) - P(K) = 1.05K e^{-r(T-t)} N(-d_2(1.05K)) - S_t N(-d_1(1.05K)) - (K e^{-r(T-t)} N(-d_2(K)) - S_t N(-d_1(K)))
		\end{dmath*}
		where
		\begin{align*}
		d_1(K) &= \frac{1}{\sigma\sqrt{T - t}}\left[\ln\left(\frac{S_t}{K}\right) + \left(r + \frac{\sigma^2}{2}\right)(T - t)\right] \\
		d_2(K) &= d_1 - \sigma\sqrt{T - t}
		\end{align*}
		$\sigma$ is the implied volatility that one can choose to equate theoretical prices to market prices.

		Using a solver, we get $\sigma_{CS} = 14.13\%$ using the 5\% call spread and $\sigma_{PS} = 17.10 \%$ using the 5\% put spread.
		
		These levels are relatively close to the implied volatility quoted for ATM (15.4 \%) and 5\% OTM options (14\% to 16.7\%)

		\end{solution}

	\end{enumerate}

\newpage

\section*{Problem 2}

	\begin{enumerate}[label=(\alph*)]

		\item Using the numerical package of your choice, calibrate the parameters of the SVI model against the market-implied volatility data. Show a comparative graph of the SVI curve and the actual implied volatility data points.

		\begin{solution}
		
		The SVI model reads: 
		$$ \sigma^* = \sqrt{a + b \left( \rho (x - m)  + \sqrt{(x-m)^2 + s^2} \right)} $$

		To calibrate its parameters ($a, b, \rho, m, s$) we perform the following least square optimization against market data, with the following constraints to avoid arbitrage:
        \begin{subequations}
        	\begin{alignat*}{2}
        	&\!\min_{a,b,\rho,m,s}        &\quad& \sum_{i=1}^{n} \left[ \sigma_{\text{SVI}}^{\star^2}(k_i,T;a,b,\rho,m,s) - \sigma_{\text{Market}}^{\star^2}(k_i,T)\right]^2\\
        	&\text{subject to} &      & a,b \geq 0,\\
        	&                  &      & -1 \leq \rho \leq 1,\\
        	&                  &      & s > 0,\\
        	&                  &      & b(1 + |\rho|)T \leq 4.
        	\end{alignat*}
        \end{subequations}
    	
		Using a Sequential Least Squares Programming method in \texttt{scipy.minimize}, we obtain: $$a = 0.000364, b = 2.55, \rho = 0.961, m = 0.239, s = 0.0149$$

		\end{solution}

		\item Compute or estimate the price of an at-the-money digital call option paying off $\$1$ if in one year NDX is greater than its current spot level, and zero otherwise: (i) in the Black-Scholes model, (ii) using $\pm 1\%$ call spreads, (iii) using the smile-adjusted formula on page 19.

		\begin{solution}

		\begin{enumerate}
			\item[$\bullet$] Black-Scholes model: $D_{BS}(S_t,K,r,T,\sigma)=e^{-rT}N(d_2)$. We obtain: 0.49.
			\item[$\bullet$] Using $\pm 1\%$ call spreads. We obtain: 0.42.
			\item[$\bullet$] Using smile-adjusted formula: $D(S_t,K,r,T) = (D_{BS}- V_{BS} \times \frac{\partial \sigma^*}{\partial K})(S_t,K,r,T,\sigma^*(K,T))$, where $V_{BS}$ is the Black-Scholes vega, $V_{BS} = S_t \frac{e^{-\frac{d_1^2}{2}}}{\sqrt{2\pi}} \sqrt{T-t}$. We obtain: 0.59.
		\end{enumerate}

		\end{solution}

		\item Graph the implied distribution corresponding to the SVI model calibration.

		\begin{solution}

			TODO

		\end{solution}

		\item Use the implied distribution to compute the price of the following European exotic options, where $X_0$ is the current index level and $X_T$ is the final index level:

		\begin{solution}

			\begin{enumerate}[label=(\roman*)]

				\item Digital call defined in question (b);

				TODO

				\item "Reverse convertible" paying off $\max\left(100\%, 100\% + p \times \frac{X_T- X_0}{X_0}\right)$ if $\frac{X_T}{X_0} > 75 \%$ and $\frac{X_T}{X_0}$ otherwise, where $p = 50\%$. Then solve for $p$ to get a price of $100\%$;

				TODO

				\item Option paying off $\max\left(0, \frac{X_T- X_0}{X_T}\right)$;

				TODO

				\item Log-contract paying off $-2\log\left(\frac{X_T}{X_0}\right)$. Price interpretation;

				TODO

			\end{enumerate}

		\end{solution}

	\end{enumerate}

\newpage

\section*{Problem 3}
Find conditions on the SVI model parameters to satisfy Leeâ€™s asymptotic bounds on p$.\ 22$: 
$$\sigma^{\star^2} (k_F,T) \leq \frac{\beta}{T} |\log{k_F}|,\, \beta \in [0,2]$$

	\begin{solution}

	TODO

	\end{solution}

\newpage

\section*{Problem 4}
(Problem $4.3$ p$.\ 56$ in textbook, with corrections): Consider an underlying stock $S$ currently trading at $S_0 = 100$ which does not pay any dividend. Assume the local volatility function is $\sigma_{loc} (t, S) = \frac{0.1 - 0.15 \times \log\left(\frac{S}{S_0}\right)}{\sqrt{t}}$, and that interest rates are zero.

	\begin{enumerate}[label=(\alph*)]
		
		\item Produce the graph of the local volatility surface for spots $0$ to $200$ and maturities $0$ to $5$ years.
		
		\begin{solution}
			
			TODO
			
		\end{solution}
		
		\item Write a Monte-Carlo algorithm to price the following $1$-year payoffs using $252$ time steps and e.g.\ $10,000$ paths:
		
		\begin{solution}
			
			\begin{enumerate}[label=(\roman*)]
	
				\item "Capped quadratic" option: $\min\left(1,\frac{S_1^2}{S_0^2}\right)$;
								
				TODO
				
				\item Asian at-the-money-call: $\max\left(0, \frac{S_{0.25} + S_{0.5} + S_{0.75} + S_1}{4 \times S_0} - 1\right)$;
				
				TODO
				
				\item Barrier call: $\max(0, S_1 - S_0)$ if $S$ always traded above $80$ using $252$ daily observations, 0 otherwise;
				
				TODO
				
			\end{enumerate}
			
		\end{solution}
		
	\end{enumerate}

\newpage

\section*{Problem 5}
The payoff of a $1$-year at-the-money call on the geometric average return of two non-dividend paying stocks $X, Y$ is given as:

$$ f(X_T,Y_T) = \max\left(0, \sqrt{\frac{X_T Y_T}{X_0 Y_0}} - 1\right)$$

where $T = 1$ year and $X_t, Y_t$ are the respective underlying spot prices of $X, Y$ at any time $t$.
	
	\begin{enumerate}[label=(\alph*)]
		
		\item Derive analytical formulas for the call value at any time $0 \leq t \leq T$ in the Black-Scholes model with constant correlation $\rho$ (cf.\ Section $6-4$ in the textbook, to be covered during Session $5$.)
		
		\begin{solution}
			
			TODO
			
		\end{solution}
		
		\item Compute the value of the call using a $5\%$ interest rate, $20\%$ volatility for $X$, $30\%$ volatility for $Y$, and $\rho = 0.4$. Use finite differences to estimate the deltas, gammas and cross-gamma of the call.
		
		\begin{solution}
			
			TODO
			
		\end{solution}
		
		\item You purchased the call on a $\$10,000,000$ notional. What actions would you take to delta-hedge your position? What would then be your instant $P\&L$ in the following matrix of scenarios. Generally, graph your instant $P\&L$ against percent changes $x, y$ in underlying stock prices.
		
		\begin{solution}
			
			TODO
			
		\[
		\linethickness{1pt}
		\setlength{\arrayrulewidth}{1pt}
		\begin{tabular}{|c|c|c|c|}
			\hline
			\backslashbox{$\quad X$}{$\quad Y$} & $\qquad -5\% \qquad$ & \qquad $+1\%\qquad$ & \qquad $+5\%\qquad$ \\ \hline
			$-5\%$ &  &  & \\ \hline
			$+1\%$ &  &  & \\ \hline
			$+5\%$ &  &  & \\ \hline
		\end{tabular}
		\]
			
		\end{solution}
	
	\end{enumerate}

\end{document}